import{a as H,b as re,c as ae,d as se,e as le,f as V,g as me}from"./chunk-YUYHHOXC.js";import{Ca as oe,Ia as ne,Xa as P,Za as F,c as R,d as X,g as h,h as Z,oa as te,p as T,q as ee,r as E,s as L,u as $,ya as ie}from"./chunk-5XOKXHOO.js";import{Ab as K,Bb as Q,Cb as q,Da as c,Db as Y,Fb as M,Ja as p,Ka as N,O as D,Ob as _,Pa as S,Pb as C,Wa as f,Z as b,Za as G,_ as x,a as z,cb as n,db as i,eb as J,ib as y,mb as d,nb as v,xb as o,ya as s,yb as u,zb as g}from"./chunk-FDL6A7KK.js";var j=class a{static \u0275fac=function(e){return new(e||a)};static \u0275cmp=p({type:a,selectors:[["booking-confirmation"]],decls:7,vars:0,consts:[[1,"text-center","mt-10","text-gray-500"],[1,"text-2xl","font-semibold"],[1,"mt-4"],["routerLink","/user",1,"mt-4","inline-block","text-blue-600","underline"]],template:function(e,r){e&1&&(n(0,"div",0)(1,"h2",1),o(2,"\u{1F389} Booking Confirmed!"),i(),n(3,"p",2),o(4,"A QR Code has been sent to your email."),i(),n(5,"a",3),o(6,"Back to Events"),i()())},dependencies:[L],encapsulation:2})};var A=class a{constructor(t,e,r){this.route=t;this.router=e;this.eventService=r}event;ngOnInit(){let t=this.route.snapshot.paramMap.get("id");console.log("Raw route param:",t);let e=Number(t);if(console.log("Parsed ID:",e),!e||isNaN(e)){console.error("Invalid event ID");return}this.eventService.getEventById(e).subscribe({next:r=>{this.event=r},error:r=>{console.error("Error fetching event:",r)}})}proceedToBooking(){this.router.navigate(["/user/seat-picker",this.event.id])}static \u0275fac=function(e){return new(e||a)(c(T),c(E),c(V))};static \u0275cmp=p({type:a,selectors:[["event-details"]],decls:12,vars:5,consts:[[1,"p-4","max-w-2xl","mx-auto","text-gray-500"],[1,"text-2xl","font-bold","mb-2"],[1,"mb-2","text-lg"],[1,"mt-4","bg-blue-500","text-white","px-4","py-2","border-round","text-lg",3,"click"]],template:function(e,r){e&1&&(n(0,"div",0)(1,"h1",1),o(2),i(),n(3,"p",2),o(4),i(),n(5,"p")(6,"strong"),o(7,"Date:"),i(),o(8),_(9,"date"),i(),n(10,"button",3),d("click",function(){return r.proceedToBooking()}),o(11,"Pick Seats"),i()()),e&2&&(s(2),u(r.event==null?null:r.event.halls),s(2),u(r.event==null?null:r.event.description),s(4),g(" ",C(9,3,r.event==null?null:r.event.dateTime),""))},dependencies:[h],encapsulation:2})};function ue(a,t){if(a&1){let e=y();n(0,"div",2)(1,"h2",3)(2,"strong"),o(3,"Hall Name"),i(),o(4),i(),n(5,"strong"),o(6,"Location"),i(),o(7,":"),n(8,"p"),o(9),i(),n(10,"strong"),o(11,"Id"),i(),o(12,":"),n(13,"p"),o(14),i(),n(15,"strong"),o(16,"Description"),i(),o(17,":"),n(18,"p"),o(19),i(),n(20,"strong"),o(21,"Total Seats"),i(),o(22,":"),n(23,"p"),o(24),i(),n(25,"strong"),o(26,"Avaible Seats"),i(),o(27,":"),n(28,"p"),o(29),i(),n(30,"strong"),o(31,"Image"),i(),o(32,":"),n(33,"p"),o(34),i(),n(35,"strong"),o(36,"Time"),i(),o(37,":"),n(38,"p",4),o(39),_(40,"date"),i(),n(41,"button",5),d("click",function(){let l=b(e).$implicit,m=v();return x(m.viewDetails(l.id))}),o(42,"View"),i()()}if(a&2){let e=t.$implicit;s(4),g(":",e.halls,""),s(5),u(e.location),s(5),u(e.id),s(5),u(e.description),s(5),u(e.totalSeat),s(5),u(e.availableSeat),s(5),u(e.imageUrl),s(5),g("Date: ",C(40,8,e.dateTime),"")}}var U=class a{constructor(t,e){this.eventService=t;this.router=e}events=[];ngOnInit(){this.eventService.getAllEvents().subscribe({next:t=>{this.events=t},error:t=>{console.error("Not found",t)}})}viewDetails(t){this.router.navigate(["user","event-details",t])}static \u0275fac=function(e){return new(e||a)(c(V),c(E))};static \u0275cmp=p({type:a,selectors:[["event-list"]],decls:2,vars:1,consts:[[1,"p-4","grid","md:grid-cols-2","lg:grid-cols-3","gap-4","text-gray-500"],["class","border rounded-xl p-4 shadow-md text-lg",4,"ngFor","ngForOf"],[1,"border","rounded-xl","p-4","shadow-md","text-lg"],[1,"text-xl","font-bold"],[1,"text-sm","text-gray-500","text-lg"],[1,"mt-2","bg-blue-500","text-white","px-6","py-2","border-round","text-lg",3,"click"]],template:function(e,r){e&1&&(n(0,"div",0),S(1,ue,43,10,"div",1),i()),e&2&&(s(),f("ngForOf",r.events))},dependencies:[R,h],encapsulation:2})};var ve=()=>["A","B","C","D"],B=class a{constructor(t,e,r){this.route=t;this.bookService=e;this.router=r}eventId;selectedSeats=[];bookedSeats=[];isLoading=!1;ngOnInit(){this.eventId=+this.route.snapshot.paramMap.get("id"),console.log("Fetching booked seats for eventId:",this.eventId),this.bookService.getBookedSeats(this.eventId).subscribe(t=>{console.log("Received booked seats:",t),this.bookedSeats=t},t=>console.error("Error fetching booked seats:",t))}onSeatSelection(t){console.log("Seats selected:",t),this.selectedSeats=t}book(){this.isLoading=!0,this.bookService.bookEvent(this.eventId,this.selectedSeats).subscribe({next:t=>{console.log("Booking successful",t),this.bookService.getBookedSeats(this.eventId).subscribe(e=>{this.bookedSeats=[...e],this.router.navigate(["user/booking/confirmation"])}),this.isLoading=!1},error:t=>console.error("Booking failed",t)})}static \u0275fac=function(e){return new(e||a)(c(T),c(H),c(E))};static \u0275cmp=p({type:a,selectors:[["seat-picker"]],decls:4,vars:6,consts:[[1,"max-w-30rem","mx-auto","text-lg"],[3,"selectedSeats","rows","seatsPerRow","bookedSeats"],["pButton","",1,"bg-blue-500","p-4","text-white","border-round","mt-3","w-full","text-lg",3,"click","loading","disabled"]],template:function(e,r){e&1&&(n(0,"div",0)(1,"seat-layout",1),d("selectedSeats",function(m){return r.onSeatSelection(m)}),i(),n(2,"button",2),d("click",function(){return r.book()}),o(3,"Book Now"),i()()),e&2&&(s(),f("rows",M(5,ve))("seatsPerRow",10)("bookedSeats",r.bookedSeats),s(),f("loading",r.isLoading)("disabled",r.selectedSeats.length===0))},dependencies:[me,F,P],encapsulation:2})};var O=class a{static \u0275fac=function(e){return new(e||a)};static \u0275cmp=p({type:a,selectors:[["user-layout"]],decls:7,vars:0,consts:[[1,"bg-blue-600","max-w-30rem","mx-auto","my-6","p-3"],[1,"flex","justify-content-between","text-xl"],["routerLink","event/:id"],["routerLink","book-history",1,"mx-2"]],template:function(e,r){e&1&&(n(0,"div",0)(1,"div",1)(2,"a",2),o(3,"Book an Event"),i(),n(4,"a",3),o(5,"Booking History"),i()()(),J(6,"router-outlet"))},dependencies:[ee,L],encapsulation:2})};var be=()=>({width:"400px"});function xe(a,t){if(a&1){let e=y();n(0,"div",7)(1,"p")(2,"strong"),o(3,"S/N:"),i(),o(4),i(),n(5,"p")(6,"strong"),o(7,"Event:"),i(),o(8),i(),n(9,"p")(10,"strong"),o(11,"Seat:"),i(),o(12),i(),n(13,"p")(14,"strong"),o(15,"Date:"),i(),o(16),_(17,"date"),i(),n(18,"p")(19,"strong"),o(20,"QR Code:"),i(),o(21),i(),n(22,"div",8)(23,"button",9),d("click",function(){let l=b(e).$implicit,m=v();return x(m.deleteBooking(l.id))}),o(24," Delete "),i(),n(25,"button",10),d("click",function(){let l=b(e).$implicit,m=v();return x(m.openEditDialog(l))}),o(26," Edit "),i()()()}if(a&2){let e=t.$implicit;s(4),g(" ",e.id,""),s(4),K(" ",e.events.halls," (",e.events.location,")"),s(4),g(" ",e.seatNumber,""),s(4),g(" ",C(17,6,e.bookedAt),""),s(5),g(" ",e.qrCode,"")}}function ke(a,t){if(a&1){let e=y();n(0,"div")(1,"div",11)(2,"label",12),o(3,"Seat Number"),i(),n(4,"p-inputNumber",13),Y("ngModelChange",function(l){b(e);let m=v();return q(m.selectedBooking.seatNumber,l)||(m.selectedBooking.seatNumber=l),x(l)}),i()()()}if(a&2){let e=v();s(4),Q("ngModel",e.selectedBooking.seatNumber)}}function Se(a,t){if(a&1){let e=y();n(0,"button",14),d("click",function(){b(e);let l=v();return x(l.closeDialog())}),i(),n(1,"button",15),d("click",function(){b(e);let l=v();return x(l.saveBookingUpdate())}),i()}}var w=class a{constructor(t){this.bookingService=t}bookings=[];selectedBooking=null;displayEditDialog=!1;ngOnInit(){this.bookingService.getUserBookings().subscribe({next:t=>this.bookings=t,error:t=>console.error("Failed to load booking history",t)})}deleteBooking(t){confirm("Are you sure you want to delete this booking?")&&this.bookingService.deleteBooking(t).subscribe({next:()=>this.bookings=this.bookings.filter(e=>e.id!==t),error:e=>console.error("Delete failed",e)})}openEditDialog(t){this.selectedBooking=z({},t),this.displayEditDialog=!0}closeDialog(){this.displayEditDialog=!1,this.selectedBooking=null}saveBookingUpdate(){this.selectedBooking&&this.bookingService.updateBooking(this.selectedBooking.id,this.selectedBooking).subscribe({next:t=>{let e=this.bookings.findIndex(r=>r.id===t.id);e!==-1&&(this.bookings[e]=t),this.closeDialog()},error:t=>console.error("Update failed",t)})}static \u0275fac=function(e){return new(e||a)(c(H))};static \u0275cmp=p({type:a,selectors:[["book-history"]],decls:8,vars:8,consts:[[1,"p-4","max-w-30rem","mx-auto","text-gray-500"],[1,"text-2xl","font-bold","mb-4","text-center"],["class","border-3 p-4 border-round mb-3 shadow text-lg",4,"ngFor","ngForOf"],["header","Edit Booking",3,"visibleChange","visible","modal","closable"],[1,"p-fluid"],[4,"ngIf"],["pTemplate","footer"],[1,"border-3","p-4","border-round","mb-3","shadow","text-lg"],[1,"mt-2","flex","gap-2"],[1,"bg-red-500","text-white","px-5","py-1","border-round","text-lg",3,"click"],[1,"bg-yellow-500","text-white","px-5","py-1","border-round","text-lg",3,"click"],[1,"field"],["for","seatNumber"],["inputId","seatNumber",3,"ngModelChange","ngModel"],["pButton","","label","Cancel","icon","pi pi-times",1,"p-button-text",3,"click"],["pButton","","label","Save","icon","pi pi-check","autofocus","",3,"click"]],template:function(e,r){e&1&&(n(0,"div",0)(1,"h2",1),o(2,"Your Booking History"),i(),S(3,xe,27,8,"div",2),i(),n(4,"p-dialog",3),Y("visibleChange",function(m){return q(r.displayEditDialog,m)||(r.displayEditDialog=m),m}),n(5,"div",4),S(6,ke,5,1,"div",5),i(),S(7,Se,2,0,"ng-template",6),i()),e&2&&(s(3),f("ngForOf",r.bookings),s(),G(M(7,be)),Q("visible",r.displayEditDialog),f("modal",!0)("closable",!1),s(2),f("ngIf",r.selectedBooking))},dependencies:[h,R,ne,ie,oe,le,se,te,F,P,ae,re,X],encapsulation:2})};var ye=[{path:"",component:O,children:[{path:"booking/confirmation",component:j},{path:"event-details/:id",component:A},{path:"event/:id",component:U},{path:"seat-picker/:id",component:B},{path:"book-history",component:w}]}],W=class a{static \u0275fac=function(e){return new(e||a)};static \u0275mod=N({type:a});static \u0275inj=D({imports:[$.forChild(ye),$]})};var pe=class a{static \u0275fac=function(e){return new(e||a)};static \u0275mod=N({type:a});static \u0275inj=D({imports:[Z,W,B,w]})};export{pe as UserModule};
